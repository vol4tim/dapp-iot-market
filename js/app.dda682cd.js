(function(e){function t(t){for(var i,o,s=t[0],l=t[1],c=t[2],d=0,f=[];d<s.length;d++)o=s[d],r[o]&&f.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={app:0},a=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var i=n("64a9"),r=n.n(i);r.a},1:function(e,t){},2:function(e,t){},"26dd":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="26dd"},3:function(e,t){},"38e8":function(e,t,n){},4:function(e,t){},4808:function(e,t,n){"use strict";var i=n("38e8"),r=n.n(i);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d"),n("db4d");var i=n("a026"),r=n("ce5b"),a=n.n(r),o=n("c0a4"),s=n.n(o),l=n("5a0d"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("v-app",{attrs:{id:"inspire"}},[n("v-content",[n("v-container",{staticStyle:{margin:"18px auto 15px"},attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[n("v-flex",{attrs:{sm12:"",md10:"",lg6:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[n("router-link",{attrs:{to:"/"}},[n("img",{staticStyle:{height:"45px"},attrs:{alt:"",src:"static/assets/i/logo.svg"}})])],1)],1)],1)],1)],1),n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("web3-check",{attrs:{networks:e.network},on:{changeNetwork:e.onChangeNetwork,changeAccount:e.onChangeAccount}},[n("router-view")],1)],1)],1)],1)],1)},u=[],d=(n("c5f6"),n("a4bb")),f=n.n(d),p=4,v={355:{ens:"0x4e978ed8a05b516d8130ff7df54fbc8b7ceb6442",ensSuffix:"sid",lighthouse:"airalab.lighthouse.4.robonomics.sid"}},m="https://wss.pool.aira.life",b="https://devjs-01.corp.aira.life:3024/",h={repo:"ipfs/robonomics",config:{Addresses:{Swarm:["/dns4/ws-star.discovery.libp2p.io/tcp/443/wss/p2p-websocket-star"]},Bootstrap:["/dns4/ams-1.bootstrap.libp2p.io/tcp/443/wss/ipfs/QmSoLer265NRgSp2LA3dPaeykiS1J6DifTC88f5uVQKNAd","/dns4/lon-1.bootstrap.libp2p.io/tcp/443/wss/ipfs/QmSoLMeWqB7YGVLJN3pNLQpmmEk35v6wYtsMGLzSr5QBU3","/dns4/nyc-1.bootstrap.libp2p.io/tcp/443/wss/ipfs/QmSoLueR4xBeUbY9WZ9xGUUxunbKWcrNFTDAadQJmocnWm","/dns4/nyc-2.bootstrap.libp2p.io/tcp/443/wss/ipfs/QmSoLV4Bbm51jM9C4gDYZQ9Cy3U6aXMJDAbzgu2fzaDs64","/dns4/node0.preload.ipfs.io/tcp/443/wss/ipfs/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/ipfs/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/wss.ipfs.pool.aira.life/tcp/443/wss/ipfs/QmdfQmbmXt6sqjZyowxPUsmvBsgSGQjm4VXrV7WGy62dv8"]}},g=f()(v).map(function(e){return Number(e)}),w={name:"App",data:function(){return{network:g}},methods:{onChangeNetwork:function(e){!0===e.check&&window.location.reload(!1)},onChangeAccount:function(){window.location.reload(!1)}}},y=w,_=(n("034f"),n("2877")),k=Object(_["a"])(y,c,u,!1,null,null,null),x=k.exports,S=n("8c4f"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"text-xs-center"},[e._v("Welcome to the First Robonomics IoT market!")]),e.robonomicsStatus?e._e():n("v-container",{staticClass:"px-3",attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"justify-center":"","align-center":""}},[n("v-flex",{attrs:{"text-xs-center":""}},[n("h1",[e._v("Load robonomics")]),n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1)],1)],1),e.robonomicsStatus?n("v-container",{staticClass:"px-3",attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[n("v-flex",{attrs:{sm12:"",md10:"",lg6:""}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{staticClass:"text-xs-center",attrs:{md12:""}},[n("h3",{staticClass:"headline mb-0 text-xs-center"},[e._v("Digital market channel / Lighthouse:")]),n("b",[e._v(e._s(e.lighthouseName))])])],1)],1)],1),n("v-card-text",[n("demand-form",{ref:"demandForm"}),e.price.value>0?n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{md12:""}},[n("div",[e._v("\n                    Cost: "+e._s(e.price.valueStr)+" |\n                    Balance: "+e._s(e.balance.valueStr)+" |\n                    Approved: "+e._s(e.approveTrade.valueStr)+"\n                  ")])])],1)],1):e._e(),e.isOrder?n("div",{staticClass:"text-xs-center"},[e.approveTrade.value<e.price.value?n("v-btn",{attrs:{loading:e.loadingApprove,disabled:e.loadingApprove||e.balance.value<e.price.value,color:"warning"},nativeOn:{click:function(t){return e.sendApproveTrade(t)}}},[e._v("\n                Approve\n              ")]):e._e(),e.approveTrade.value>=e.price.value?n("v-btn",{attrs:{loading:e.loadingOrder,disabled:e.loadingOrder||e.balance.value<e.price.value,color:"warning"},nativeOn:{click:function(t){return e.order(t)}}},[e._v("\n                Order\n              ")]):e._e()],1):n("div",{staticClass:"text-xs-center"},[n("v-btn",{attrs:{disabled:"",color:"warning"}},[e._v("\n                Please, choose offer bellow\n              ")])],1)],1)],1),e.liability?n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("h3",{staticClass:"headline mb-0"},[e._v("Received data")])])]),n("v-card-text",[n("Liability",{attrs:{liability:e.liability}})],1)],1):e._e(),n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{md12:""}},[n("h3",{staticClass:"headline mb-0 text-xs-center"},[e._v("Offers")])])],1)],1)],1),n("v-card-text",[n("v-btn-toggle",{on:{change:e.load},model:{value:e.toggle_filter,callback:function(t){e.toggle_filter=t},expression:"toggle_filter"}},[n("v-btn",{attrs:{value:"h",flat:""}},[e._v("\n                hour\n              ")]),n("v-btn",{attrs:{value:"d",flat:""}},[e._v("\n                day\n              ")]),n("v-btn",{attrs:{value:"m",flat:""}},[e._v("\n                month\n              ")])],1),n("v-divider"),null===e.offers?n("v-progress-linear",{attrs:{indeterminate:!0}}):n("div",[n("v-list",{attrs:{"two-line":""}},[n("v-data-iterator",{attrs:{items:e.offers,pagination:e.pagination,"hide-actions":""},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"item",fn:function(t){return[n("v-list-tile",{attrs:{avatar:""},on:{click:function(n){e.setForm(t.item.id)}}},[n("v-list-tile-avatar",[n("span",{domProps:{innerHTML:e._s(e.icon(t.item.account))}})]),n("v-list-tile-content",[n("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.account)}}),n("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.item.msg.model)}})],1)],1),n("v-divider")]}}])})],1),e.pages>1?n("v-pagination",{attrs:{length:e.pages},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}}):e._e()],1)],1)],1)],1)],1)],1):e._e()],1)},j=[],M=n("f499"),N=n.n(M),A=n("cebc"),T=(n("ac6a"),n("7f7f"),n("f684")),F=n.n(T),P=n("bc3a"),C=n.n(P),L=n("2769"),R=n.n(L),$=n("9380"),D=n.n($),Q=n("3852"),q=n.n(Q),B=n("ff60"),J=n.n(B),E=n("795b"),U=n.n(E),I=n("d225"),Z=n("b0b4"),W=n("308d"),z=n("6bb5"),G=n("4e2b"),V=function(e){function t(e){var n;return Object(I["a"])(this,t),n=Object(W["a"])(this,Object(z["a"])(t).call(this)),n.socket=e,n.topic=null,n}return Object(G["a"])(t,e),Object(Z["a"])(t,[{key:"ready",value:function(){var e=this;return new F.a(function(t){e.socket.on("reconnect",function(){null!==e.topic&&e.watch(e.topic[0],e.topic[1])}),e.socket.on("connect",function(){t()})})}},{key:"push",value:function(e,t){var n=this;return new F.a(function(i){n.socket.emit(e,N()(t)),i()})}},{key:"watch",value:function(e,t){this.topic=[e,t],this.socket.emit("chanel",e),this.socket.on(e,function(e){t(e)})}}]),t}(B["MessageProviderAbstract"]),Y=null,H=function(){return null===Y?new U.a(function(e,t){web3.version.getNetwork(function(n,i){if(!v.hasOwnProperty(Number(i)))return t(new Error("No support network"));var r=io(m);Y=new J.a({web3:web3,provider:new V(r),ens:v[Number(i)].ens,ensSuffix:v[Number(i)].ensSuffix,lighthouse:v[Number(i)].lighthouse,version:p}),e(Y)})}):U.a.resolve(Y)},X=H,K=(n("5df3"),n("a745")),ee=n.n(K),te=(n("6b54"),function(e,t){var n=new web3.BigNumber(e);return n.shift(-t).toString(10)}),ne=function e(t){var n=function e(n,i){web3.eth.getTransactionReceipt(t,function(t,r){t?i(t):null===r?setTimeout(function(){return e(n,i)},5e3):n(r)})};if(ee()(t))return U.a.all(t.map(function(t){return e(t)}));if("string"===typeof t)return new U.a(n);throw new Error("Invalid Type: ".concat(t))},ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.liability.address?n("div",[n("b",[e._v("liability: ")]),e._v(e._s(e.liability.address)),n("br"),n("b",[e._v("model: ")]),e._v(e._s(e.liability.model)),n("br"),n("b",[e._v("objective: ")]),e._v(e._s(e.liability.objective)),n("br"),n("b",[e._v("token: ")]),e._v(e._s(e.liability.token)),n("br"),n("b",[e._v("cost: ")]),e._v(e._s(e.liability.cost)),n("br"),n("b",[e._v("promisee: ")]),e._v(e._s(e.liability.promisee)),n("br"),n("b",[e._v("promisor: ")]),e._v(e._s(e.liability.promisor)),n("br")]):e._e(),""!=e.liability.result?n("span",[n("b",[e._v("IPFS hash of data: ")]),n("a",{attrs:{href:"https://ipfs.io/ipfs/"+e.liability.result,target:"_blank"}},[e._v(e._s(e.liability.result))]),!0===e.liability.check?n("v-icon",{attrs:{large:"",color:"green darken-2"}},[e._v("mdi-check")]):e._e(),!1===e.liability.check?n("v-icon",{attrs:{large:"",color:"blue-grey darken-2"}},[e._v("mdi-alert-circle-outline")]):e._e(),n("br"),n("b",[e._v("Data: ")]),0===e.liability.resultMessage.length?n("v-progress-linear",{attrs:{indeterminate:!0}}):n("div",e._l(e.liability.resultMessage,function(t,i){return n("div",{key:i},[1===t.type?n("div",[n("div",{staticStyle:{border:"1px solid #cccaca",margin:"10px 0",width:"200px",padding:"10px","text-align":"center"}},[n("img",{attrs:{width:"64",height:"64",src:"//openweathermap.org/themes/openweathermap/assets/vendor/owm/img/widgets/"+t.json.weather[0].icon+".png"}}),n("v-divider"),n("div",{staticStyle:{"padding-top":"15px"}},[n("b",[e._v(e._s(parseInt(t.json.main.temp)-273)),n("span",[e._v("°C")])])])],1),n("code",{staticStyle:{width:"100%"}},[n("pre",[e._v(e._s(t.str))])])]):2===t.type?n("div",[n("code",{staticStyle:{width:"100%"}},[n("pre",[e._v(e._s(t.str))])])]):n("p",[e._v(e._s(t.str))])])}),0)],1):e._e(),""==e.liability.result?n("span",[n("b",[e._v("IPFS hash of data: ")]),n("v-progress-linear",{attrs:{indeterminate:!0}})],1):e._e()])},re=[],ae={name:"Liability",props:["liability"]},oe=ae,se=(n("4808"),Object(_["a"])(oe,ie,re,!1,null,null,null)),le=se.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{attrs:{rules:e.requireRule,label:"model",required:""},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),n("v-text-field",{attrs:{rules:e.requireRule,label:"objective",required:""},model:{value:e.objective,callback:function(t){e.objective=t},expression:"objective"}}),n("v-text-field",{attrs:{rules:e.requireRule,label:"token",required:""},model:{value:e.token,callback:function(t){e.token=t},expression:"token"}}),n("v-text-field",{attrs:{label:"cost",required:""},model:{value:e.cost,callback:function(t){e.cost=t},expression:"cost"}}),n("v-text-field",{attrs:{rules:e.requireRule,label:"deadline",required:""},model:{value:e.deadline,callback:function(t){e.deadline=t},expression:"deadline"}})],1)],1)},ue=[],de={data:function(){return{valid:!1,model:"",objective:"",token:"",cost:"",deadline:"",requireRule:[function(e){return!!e||"Field required"}]}}},fe=de,pe=Object(_["a"])(fe,ce,ue,!1,null,null,null),ve=pe.exports,me=null,be=function(){if(null!==me)return F.a.resolve(me);var e=function(e,t){me=new Ipfs(h),me.once("ready",function(){return me.id(function(n,i){if(n)return t(n);console.log("ipfs id "+i.id),window.ipfsi=me,e(me)})})},t=function(t,n){"undefined"!==typeof window&&window.ipfs?window.ipfs.swarm.peers().then(function(){me=window.ipfs,t(me)}).catch(function(){console.log("not glogal ipfs"),e(t,n)}):e(t,n)};return"complete"!==document.readyState?new F.a(function(e,n){window.addEventListener("load",function(){t(e,n)})}):new F.a(function(e,n){t(e,n)})},he=be;function ge(){return new F.a(function(){})}function we(e){return e.catch(ge)}function ye(e){return F.a.race(e.map(we))}var _e,ke=function(e){return C.a.get("https://ipfs.io/ipfs/".concat(e),{responseType:"blob"}).then(function(e){return e.data})},xe=function(e){var t=[ke(e)];return q()(me,"cat")?t.push(me.cat(e)):q()(me,"files")&&q()(me.files,"cat")&&t.push(me.files.cat(e)),ye(t)},Se=n("1cba"),Oe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(Se["open"])(e).then(function(e){e.readMessages(n,function(e){t(e)})})},je=null,Me=function(e){if(null===je)return je=io(b),void je.on("connect",function(){console.log("connect"),e(je)});e(je)},Ne=Me,Ae={name:"info",components:{Liability:le,DemandForm:ve},data:function(){return{robonomicsStatus:!1,token:null,price:{value:0,valueStr:""},loadingApprove:!1,loadingOrder:!1,isOrder:!1,balance:{value:0,valueStr:""},approveTrade:{value:0,valueStr:""},lighthouseName:"",liability:null,offers:[],pagination:{rowsPerPage:10},toggle_filter:"h"}},computed:{pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)}},created:function(){var e=this;return he().then(function(){return X()}).then(function(e){return _e=e,_e.ready()}).then(function(){console.log("xrt",_e.xrt.address),console.log("factory",_e.factory.address),console.log("lighthouse",_e.lighthouse.address),e.lighthouseName=_e.lighthouse.name,_e.getDemand(null,function(e){console.log("demand",e)}),_e.getResult(function(t){console.log("result unverified",t),web3.toChecksumAddress(t.liability)===web3.toChecksumAddress(_e.account)?(e.liability={address:"",resultMessage:[]},e.setResult(t.result,!0)):null!==e.liability&&t.liability===e.liability.address&&e.setResult(t.result,!1)}),e.load(),Ne(function(t){t.on("add",function(t){e.offers.unshift({msg:JSON.parse(t.msg),id:t.id,account:t.account})}),t.on("remove",function(t){e.offers=D()(e.offers,function(e){return e.id!==t})})}),e.robonomicsStatus=!0})},methods:{load:function(){var e=this;this.offers=null,C.a.get(b+this.toggle_filter).then(function(t){e.offers=[],t.data.result.forEach(function(t){e.offers.push({msg:JSON.parse(t.msg),id:t.id,account:t.account})})})},icon:function(e){return jdenticon.toSvg(e,40)},setForm:function(e){var t=this;this.isOrder=!1;var n=R()(this.offers,{id:e});this.$refs.demandForm.model=n.msg.model,this.$refs.demandForm.objective=n.msg.objective,this.$refs.demandForm.token=n.msg.token,this.$refs.demandForm.cost=n.msg.cost,this.$refs.demandForm.deadline=n.msg.deadline,this.price.value=Number(n.msg.cost),this.price.value>0?(this.token=new B["Token"](_e.web3,n.msg.token),F.a.join(this.token.call("decimals"),this.token.call("symbol"),function(e,n){return t.token.decimals=e,t.token.symbol=n,t.price.valueStr="".concat(te(t.price.value,t.token.decimals)," ").concat(t.token.symbol),t.fetchBalance()}).then(function(){t.isOrder=!0})):this.isOrder=!0},fetchBalance:function(){var e=this;return this.token.call("balanceOf",[_e.account]).then(function(t){return e.balance.value=t,e.balance.valueStr="".concat(te(t,e.token.decimals)," ").concat(e.token.symbol),t>0?e.token.call("allowance",[_e.account,_e.factory.address]):0}).then(function(t){e.approveTrade.value=t,e.approveTrade.valueStr="".concat(te(t,e.token.decimals)," ").concat(e.token.symbol)})},sendApproveTrade:function(){var e=this;return this.loadingApprove=!0,this.token.send("approve",[_e.factory.address,100*this.price.value],{from:_e.account}).then(function(e){return ne(e)}).then(function(){return e.fetchBalance()}).then(function(){e.loadingApprove=!1}).catch(function(){e.loadingApprove=!1})},setResult:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.liability=Object(A["a"])({},this.liability,{result:e,check:n}),0===this.liability.resultMessage.length&&(this.liability.resultMessage.push(""),xe(e).then(function(e){Oe(new Blob([e]),function(e){try{var n=JSON.parse(e.message.data);q()(n,"weather")?t.liability.resultMessage.push({type:1,json:n,str:N()(n,void 0,2)}):t.liability.resultMessage.push({type:2,str:N()(n,void 0,2)})}catch(i){t.liability.resultMessage.push({type:3,str:e.message.data})}},{})}))},newLiability:function(e){var t=this;return console.log("liability demand",e.address),e.getInfo().then(function(n){return t.liability=Object(A["a"])({address:e.address,worker:e.worker},n,{resultMessage:[]}),e.watchResult(function(e){console.log("result",e),t.setResult(e,!0)}),!0}).catch(function(n){console.log(n),setTimeout(function(){t.newLiability(e)},2e3)})},order:function(){var e=this;if(this.$refs.demandForm.$refs.form.validate()){this.liability=null,this.loadingOrder=!0;var t={objective:this.$refs.demandForm.objective,token:this.$refs.demandForm.token,cost:this.$refs.demandForm.cost,lighthouse:_e.lighthouse.address,validator:"0x0000000000000000000000000000000000000000",validatorFee:0,deadline:this.$refs.demandForm.deadline};_e.postDemand(this.$refs.demandForm.model,t).then(function(t){return e.newLiability(t)}).then(function(){e.loadingOrder=!1}).catch(function(){e.loadingOrder=!1})}}}},Te=Ae,Fe=Object(_["a"])(Te,O,j,!1,null,null,null),Pe=Fe.exports;i["default"].use(S["a"]);var Ce=new S["a"]({routes:[{path:"/",name:"info",component:Pe}]});n("bf40");i["default"].config.productionTip=!1,i["default"].use(a.a,{theme:{warning:s.a.deepOrange.darken3}}),i["default"].use(l),new i["default"]({el:"#app",router:Ce,components:{App:x},template:"<App/>"})},"64a9":function(e,t,n){}});
//# sourceMappingURL=app.dda682cd.js.map